var characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",fromCharCode=String.fromCharCode,INVALID_CHARACTER_ERR=function(){try{document.createElement("$")}catch(f){return f}}();
window.btoa||(window.btoa=function(f){for(var b,e,g,k,c,a,d=0,p=f.length,q=Math.max,h="";d<p;){b=f.charCodeAt(d++)||0;e=f.charCodeAt(d++)||0;a=f.charCodeAt(d++)||0;if(255<q(b,e,a))throw INVALID_CHARACTER_ERR;g=b>>2&63;b=(b&3)<<4|e>>4&15;k=(e&15)<<2|a>>6&3;c=a&63;e?a||(c=64):k=c=64;h+=characters.charAt(g)+characters.charAt(b)+characters.charAt(k)+characters.charAt(c)}return h});
window.atob||(window.atob=function(f){f=f.replace(/=+$/,"");var b,e,g,k,c=0,a=f.length,d=[];if(1===a%4)throw INVALID_CHARACTER_ERR;for(;c<a;)b=characters.indexOf(f.charAt(c++)),e=characters.indexOf(f.charAt(c++)),g=characters.indexOf(f.charAt(c++)),k=characters.indexOf(f.charAt(c++)),b=(b&63)<<2|e>>4&3,e=(e&15)<<4|g>>2&15,g=(g&3)<<6|k&63,d.push(fromCharCode(b)),e&&d.push(fromCharCode(e)),g&&d.push(fromCharCode(g));return d.join("")});
ExcellentExport=function(){var f={excel:"data:application/vnd.ms-excel;base64,",csv:"data:application/csv;base64,"},b={excel:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>'},e=",",g="\r\n",k=function(c,a){return c.replace(RegExp("{(\\w+)}","g"),function(d,c){return a[c]})};return{excel:function(c,a,d,e){a=a.nodeType?a:document.getElementById(a);var g=f.excel;a=k(b.excel,{worksheet:d||"Worksheet",table:a.innerHTML});a=window.btoa(window.unescape(encodeURIComponent(a)));c.href=g+a;c.download=e;return!0},csv:function(c,a,d,b,k){void 0!==d&&d&&(e=d);void 0!==b&&b&&(g=b);a=a.nodeType?a:document.getElementById(a);var h="",n,l;for(d=0;d<a.rows.length;d++){n=a.rows[d];for(b=0;b<n.cells.length;b++){l=n.cells[b];var h=h+(b?e:""),m=l.textContent.trim();l=m;var r=-1!==m.indexOf(e)||-1!==m.indexOf("\r")||-1!==m.indexOf("\n");(m=-1!==m.indexOf('"'))&&(l=l.replace(/"/g,'""'));if(r||m)l='"'+l+'"';h+=l}h+=g}a=f.csv+window.btoa(window.unescape(encodeURIComponent(h)));c.href=a;c.download=k;return!0}}}();